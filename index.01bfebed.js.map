{"mappings":"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","sources":["src/index.js","src/js/js-partials/loadPage.js","src/js/js-partials/pagination.js","src/js/js-partials/onSearch.js"],"sourcesContent":["import './js/js-partials/API';\nimport './js/js-partials/appendFilmsMarkup';\nimport './js/js-partials/clearFilmsContainer';\nimport './js/js-partials/loadPage';\nimport './js/js-partials/onSearch';\nimport './js/js-partials/pagination';\nimport './js/js-partials/fetchMoviesByPages';\nimport './js/js-partials/teamModal';\nimport './js/js-partials/onButtonClick';\nimport './js/js-partials/openModalFilm';\nimport './js/js-partials/loader';\n\n\n\n\n\n\n\n\n","import ApiService from \"./API\";\nimport appendFilmsMarkup from \"./appendFilmsMarkup\";\nimport { renderButtons } from \"./pagination\";\n\nconst apiService = new ApiService();\nconst filmsContainerIndex = document.querySelector(\".js-films-list-index\");\n\nwindow.addEventListener(\"load\", loadPage);\n\nexport default function loadPage() {\n  apiService.fetchPopular().then(({ results, total_pages }) => {\n    appendFilmsMarkup(results, filmsContainerIndex);\n    renderButtons(apiService.page, total_pages);\n  });\n}\n","import appendFilmsMarkup from \"./appendFilmsMarkup\";\nimport clearFilmsContainer from \"./clearFilmsContainer\";\nimport MovieApiService from \"./API\";\n\nconst apiService = new MovieApiService();\n\nconst refs = {\n  arrowLeft: document.querySelector(\"button[aria-label='previous-page'\"),\n  arrowRight: document.querySelector(\"button[aria-label='next-page'\"),\n  pagination: document.querySelector(\".pagination\"),\n  firstButton: document.querySelector(\".firstButton-and-threeDots\"),\n  lastButton: document.querySelector(\".lastButton-and-threeDots\"),\n  filmsContainerIndex: document.querySelector(\".js-films-list-index\"),\n  inputError: document.querySelector(\".input__error\"),\n};\n\nlet page = 1;\nlet totalPages;\n\nfunction renderButtons(currentPage, pages) {\n  //проверка, чтобы не рендерить кнопки больше, чем есть от бекенда\n  if (page > totalPages) return;\n\n  page = currentPage;\n  totalPages = pages;\n\n  let beforeActivePage = page - 2;\n  let afterActivePage = page + 2;\n\n  //рендер, если активная кнопка среди последних\n  if (page === totalPages || page + 1 === totalPages) {\n    beforeActivePage = page - 3;\n    afterActivePage = totalPages;\n  }\n\n  //Если активная кнопка меньше 5, рендерим 5 кнопок\n  // Заодно избегаем попадания переменной beforeActivePage в минуса\n  if (beforeActivePage < 3) {\n    beforeActivePage = 1;\n    afterActivePage = 5;\n  }\n  //Проверка, что страниц не меньше 5. Если меньше - рендерим нужное количество\n  if (totalPages <= 5) {\n    beforeActivePage = page;\n    afterActivePage = totalPages;\n  }\n\n  for (let i = beforeActivePage; i <= afterActivePage; i += 1) {\n    if (i === page) {\n      const pageButton = `<button id=\"paginationButton\" data-page=\"${i}\" class=\"button-page paginationButton active\">${i}</button>`;\n      refs.pagination.insertAdjacentHTML(\"beforeend\", pageButton);\n    } else {\n      const pageButton = `<button id=\"paginationButton\" data-page=\"${i}\" class=\"button-page paginationButton\">${i}</button>`;\n      refs.pagination.insertAdjacentHTML(\"beforeend\", pageButton);\n    }\n  }\n\n  // рендер первой кнопки с точками\n  if (beforeActivePage >= 3) {\n    if (isFirstThreeDots()) {\n      return;\n    } else {\n      renderFirstButtonAndDots();\n    }\n  }\n\n  //Убираем точки и первую кнопку, если активная кнопка меньше 5 и точки существуют\n  if (beforeActivePage < 3 && isFirstThreeDots()) {\n    refs.firstButton.innerHTML = \"\";\n  }\n\n  //Долго высчитывал. Убираем последнюю кнопку и точки, если\n  //активная страница среди последних и точки существуют\n  //Если предыдущие условия не проканали, наоборот точки и последнюю кнопку рендер\n  if (\n    page === totalPages ||\n    page + 1 === totalPages ||\n    page + 2 === totalPages ||\n    page + 3 === totalPages\n  ) {\n    refs.lastButton.innerHTML = \"\";\n    return;\n  } else if (isLastThreeDots()) {\n    return;\n  } else {\n    renderLastButtonAndDots(totalPages);\n  }\n\n  //удобная замена для слушателей\n  refs.arrowLeft.onclick = onClickArrowLeft;\n  refs.arrowRight.onclick = onClickArrowRight;\n  refs.pagination.onclick = onClickButton;\n  refs.firstButton.onclick = onClickFirstButton;\n  refs.lastButton.onclick = onClickLastButton;\n}\n\nfunction onClickFirstButton(event) {\n  if (event.target.nodeName === \"BUTTON\") {\n    page = 1;\n\n    isQueryOrPopular();\n  }\n}\n\nfunction onClickLastButton(event) {\n  if (event.target.nodeName === \"BUTTON\") {\n    page = totalPages;\n\n    isQueryOrPopular();\n  }\n}\n\nfunction onClickArrowLeft() {\n  if (page === 1) return;\n  page -= 1;\n  isQueryOrPopular();\n}\n\nfunction onClickArrowRight() {\n  if (page === totalPages) return;\n\n  page += 1;\n  isQueryOrPopular();\n}\n\nfunction resetButtons() {\n  refs.pagination.innerHTML = \"\";\n  refs.firstButton.innerHTML = \"\";\n  refs.lastButton.innerHTML = \"\";\n}\n\nfunction onClickButton(event) {\n  event.preventDefault();\n  //если клик не в кнопку, а в див - ничо не делаем. Позже кнопку расширю паддингами\n  if (event.target === event.currentTarget) return;\n  page = Number(event.target.dataset.page);\n  isQueryOrPopular();\n}\n\n//проверка существования точек после первой кнопки\n//нужно для их рендера или удаления\nfunction isFirstThreeDots() {\n  const isThreeDots = document.querySelector(\".page-buttons__first-points\");\n  if (isThreeDots === null) {\n    return false;\n  }\n  return true;\n}\n\n//проверка существования точек перед последней кнопкой\n//нужно для их рендера или удаления\nfunction isLastThreeDots() {\n  const isThreeDots = document.querySelector(\".page-buttons__last-points\");\n  if (isThreeDots === null) {\n    return false;\n  }\n  return true;\n}\n\nfunction renderFirstButtonAndDots() {\n  const firstButton = `<button id=\"paginationButton\" data-page=\"1\" class=\"button-page paginationButton\">1</button>`;\n  const threeDots = `<span class='page-buttons__first-points'>···</span>`;\n  refs.firstButton.insertAdjacentHTML(\"beforeend\", firstButton);\n  refs.firstButton.insertAdjacentHTML(\"beforeend\", threeDots);\n}\n\nfunction renderLastButtonAndDots(totalPages) {\n  const lastButton = `<button id=\"paginationButton\" data-page=\"${totalPages}\" class=\"button-page paginationButton\">${totalPages}</button>`;\n  const threeDots = `<span class='page-buttons__last-points'>···</span>`;\n  refs.lastButton.insertAdjacentHTML(\"beforeend\", threeDots);\n  refs.lastButton.insertAdjacentHTML(\"beforeend\", lastButton);\n}\n\n//Рендер кнопок и карточек по поиску.\nfunction renderPaginationOnSearch(query, queryPage) {\n  apiService.query = query;\n  apiService.page = queryPage;\n  apiService.fetchMoviesySearch().then(({ results, total_pages }) => {\n    if (results.length === 0) {\n      refs.inputError.textContent =\n        \"Search result not successful. Enter the correct movie name and smile : )\";\n      return;\n    }\n    clearFilmsContainer();\n    appendFilmsMarkup(results, refs.filmsContainerIndex);\n    resetButtons();\n    renderButtons(apiService.page, total_pages);\n  });\n}\n\n//Рендер кнопок и карточек популярных фильмов\nfunction renderPaginationPopular() {\n  apiService.page = page;\n  apiService.fetchPopular().then(({ results, total_pages }) => {\n    clearFilmsContainer();\n    appendFilmsMarkup(results, refs.filmsContainerIndex);\n    resetButtons();\n    renderButtons(apiService.page, total_pages);\n  });\n}\n\n//Чё рендерить-то - популярные или поиск? Вот функция и разбирается\n//Заодно после рендера поднимает вьюпорт в самый верх\nfunction isQueryOrPopular() {\n  if (apiService.query === \"\") {\n    renderPaginationPopular();\n    moveToTop();\n    return;\n  } else {\n    renderPaginationOnSearch(apiService.query, page);\n    moveToTop();\n  }\n}\n\n//функция для поднятия в небеса\nfunction moveToTop() {\n  window.scrollTo(pageXOffset, 0);\n}\n\nexport { renderButtons, renderPaginationOnSearch };\n","// import debounce from \"lodash.debounce\";\nimport ApiService from \"./API\";\nimport appendFilmsMarkup from \"./appendFilmsMarkup\";\nimport clearFilmsContainer from \"./clearFilmsContainer\";\nimport { renderPaginationOnSearch } from \"./pagination\";\n\nconst apiService = new ApiService();\n\nconst searchForm = document.querySelector(\".input__wraper\");\nconst inputError = document.querySelector(\".input__error\");\nconst filmsContainerIndex = document.querySelector(\".js-films-list-index\");\n\nsearchForm.addEventListener(\"submit\", onSearch);\n\nexport function onSearch(e) {\n  e.preventDefault();\n\n  apiService.query = e.currentTarget.searchQuery.value;\n  apiService.resetPage();\n\n  inputError.textContent = \" \";\n\n  renderPaginationOnSearch(apiService.query, apiService.page);\n\n  //Вибач, Наталю, але мені або зробити ось так, або переписувати половину свого коду :(\n\n  apiService\n    .fetchMoviesySearch()\n    .then(({ results, total_pages }) => {\n      if (results.length === 0) {\n        inputError.textContent =\n          \"Search result not successful. Enter the correct movie name and smile : )\";\n        return;\n      }\n      clearFilmsContainer();\n      appendFilmsMarkup(results, filmsContainerIndex);\n    })\n    .catch(error => console.log(error));\n}\n"],"names":["parcelRequire","$bcd54f71f55c47f8$var$totalPages","$l7OcW","$kXDXL","$bcd54f71f55c47f8$var$apiService","default","$bcd54f71f55c47f8$var$refs","arrowLeft","document","querySelector","arrowRight","pagination","firstButton","lastButton","filmsContainerIndex","inputError","$bcd54f71f55c47f8$var$page","$bcd54f71f55c47f8$export$8f52e704dc7391ad","currentPage","pages","threeDots","beforeActivePage","afterActivePage","i","pageButton","concat","insertAdjacentHTML","pageButton1","$bcd54f71f55c47f8$var$isFirstThreeDots","innerHTML","totalPages1","$bcd54f71f55c47f8$var$renderLastButtonAndDots","onclick","$bcd54f71f55c47f8$var$onClickArrowLeft","$bcd54f71f55c47f8$var$onClickArrowRight","$bcd54f71f55c47f8$var$onClickButton","$bcd54f71f55c47f8$var$onClickFirstButton","$bcd54f71f55c47f8$var$onClickLastButton","event","target","nodeName","$bcd54f71f55c47f8$var$isQueryOrPopular","$bcd54f71f55c47f8$var$resetButtons","preventDefault","currentTarget","Number","dataset","page","$bcd54f71f55c47f8$export$64b427446bc657b7","query","queryPage","fetchMoviesySearch","then","param","results","total_pages","length","$dDwfd","textContent","fetchPopular","$bcd54f71f55c47f8$var$moveToTop","window","scrollTo","pageXOffset","$6659fec5f74257cc$var$apiService","$6659fec5f74257cc$var$filmsContainerIndex","addEventListener","$b0ceaf9131d2c62a$var$apiService","$b0ceaf9131d2c62a$var$searchForm","$b0ceaf9131d2c62a$var$inputError","$b0ceaf9131d2c62a$var$filmsContainerIndex","e","searchQuery","value","resetPage","catch","error","console","log"],"version":3,"file":"index.01bfebed.js.map"}