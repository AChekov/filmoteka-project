{"mappings":"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","sources":["src/index.js","src/js/js-partials/loadPage.js","src/js/js-partials/pagination.js","src/js/js-partials/onSearch.js"],"sourcesContent":["import './js/js-partials/API';\nimport './js/js-partials/appendFilmsMarkup';\nimport './js/js-partials/clearFilmsContainer';\nimport './js/js-partials/loadPage';\nimport './js/js-partials/onSearch';\nimport './js/js-partials/pagination';\nimport './js/js-partials/fetchMoviesByPages';\nimport './js/js-partials/teamModal';\nimport './js/js-partials/onButtonClick';\nimport './js/js-partials/openModalFilm';\nimport './js/js-partials/loader';\nimport './js/js-partials/trailer';\n\n\n\n\n\n\n\n\n","import ApiService from \"./API\";\nimport appendFilmsMarkup from \"./appendFilmsMarkup\";\nimport { renderButtons } from \"./pagination\";\n\nconst apiService = new ApiService();\nconst filmsContainerIndex = document.querySelector(\".js-films-list-index\");\n\nwindow.addEventListener(\"load\", loadPage);\n\nexport default function loadPage() {\n  apiService.fetchPopular().then(({ results, total_pages }) => {\n    appendFilmsMarkup(results, filmsContainerIndex);\n    renderButtons(apiService.page, total_pages);\n  });\n}\n","import appendFilmsMarkup from \"./appendFilmsMarkup\";\nimport clearFilmsContainer from \"./clearFilmsContainer\";\nimport MovieApiService from \"./API\";\n\nconst apiService = new MovieApiService();\n\nconst refs = {\n  arrowLeft: document.querySelector(\"button[aria-label='previous-page'\"),\n  arrowRight: document.querySelector(\"button[aria-label='next-page'\"),\n  pagination: document.querySelector(\".pagination\"),\n  firstButton: document.querySelector(\".firstButton-and-threeDots\"),\n  lastButton: document.querySelector(\".lastButton-and-threeDots\"),\n  filmsContainerIndex: document.querySelector(\".js-films-list-index\"),\n  inputError: document.querySelector(\".input__error\"),\n};\n\nlet page = 1;\nlet totalPages;\n\nfunction renderButtons(currentPage, pages) {\n  //проверка, чтобы не рендерить кнопки больше, чем есть от бекенда\n  if (page > totalPages) return;\n\n  page = currentPage;\n  totalPages = pages;\n\n  let beforeActivePage = page - 2;\n  let afterActivePage = page + 2;\n\n  //рендер, если активная кнопка среди последних\n  if (page === totalPages || page + 1 === totalPages) {\n    beforeActivePage = page - 3;\n    afterActivePage = totalPages;\n  }\n\n  //частный случай, который не попадает ни в одно из условий, которые есть в этом файле\n  //(охренеть просто)\n\n  if (page + 3 === totalPages) {\n    afterActivePage = totalPages;\n  }\n\n  //Если активная кнопка меньше 5, рендерим 5 кнопок\n  // Заодно избегаем попадания переменной beforeActivePage в минуса\n  if (beforeActivePage < 3) {\n    beforeActivePage = 1;\n    afterActivePage = 5;\n  }\n  //Проверка, что страниц не меньше 5. Если меньше - рендерим нужное количество\n  if (totalPages <= 5) {\n    beforeActivePage = page;\n    afterActivePage = totalPages;\n  }\n\n  for (let i = beforeActivePage; i <= afterActivePage; i += 1) {\n    if (i === page) {\n      const pageButton = `<button id=\"paginationButton\" data-page=\"${i}\" class=\"button-page paginationButton active\">${i}</button>`;\n      refs.pagination.insertAdjacentHTML(\"beforeend\", pageButton);\n    } else {\n      const pageButton = `<button id=\"paginationButton\" data-page=\"${i}\" class=\"button-page paginationButton\">${i}</button>`;\n      refs.pagination.insertAdjacentHTML(\"beforeend\", pageButton);\n    }\n  }\n\n  // рендер первой кнопки с точками\n  if (beforeActivePage >= 3) {\n    if (isFirstThreeDots()) {\n      return;\n    } else {\n      renderFirstButtonAndDots();\n    }\n  }\n\n  //Убираем точки и первую кнопку, если активная кнопка меньше 5 и точки существуют\n  if (beforeActivePage < 3 && isFirstThreeDots()) {\n    refs.firstButton.innerHTML = \"\";\n  }\n\n  //Долго высчитывал. Убираем последнюю кнопку и точки, если\n  //активная страница среди последних и точки существуют\n  //Если предыдущие условия не проканали, наоборот точки и последнюю кнопку рендер\n  if (\n    page === totalPages ||\n    page + 1 === totalPages ||\n    page + 2 === totalPages ||\n    page + 3 === totalPages\n  ) {\n    refs.lastButton.innerHTML = \"\";\n    return;\n  } else if (isLastThreeDots()) {\n    return;\n  } else {\n    renderLastButtonAndDots(totalPages);\n  }\n\n  //удобная замена для слушателей\n  refs.arrowLeft.onclick = onClickArrowLeft;\n  refs.arrowRight.onclick = onClickArrowRight;\n  refs.pagination.onclick = onClickButton;\n  refs.firstButton.onclick = onClickFirstButton;\n  refs.lastButton.onclick = onClickLastButton;\n}\n\nfunction onClickFirstButton(event) {\n  if (event.target.nodeName === \"BUTTON\") {\n    page = 1;\n\n    isQueryOrPopular();\n  }\n}\n\nfunction onClickLastButton(event) {\n  if (event.target.nodeName === \"BUTTON\") {\n    page = totalPages;\n\n    isQueryOrPopular();\n  }\n}\n\nfunction onClickArrowLeft() {\n  if (page === 1) return;\n  page -= 1;\n  isQueryOrPopular();\n}\n\nfunction onClickArrowRight() {\n  if (page === totalPages) return;\n\n  page += 1;\n  isQueryOrPopular();\n}\n\nfunction resetButtons() {\n  refs.pagination.innerHTML = \"\";\n  refs.firstButton.innerHTML = \"\";\n  refs.lastButton.innerHTML = \"\";\n}\n\nfunction onClickButton(event) {\n  event.preventDefault();\n  //если клик не в кнопку, а в див - ничо не делаем. Позже кнопку расширю паддингами\n  if (event.target === event.currentTarget) return;\n  page = Number(event.target.dataset.page);\n  isQueryOrPopular();\n}\n\n//проверка существования точек после первой кнопки\n//нужно для их рендера или удаления\nfunction isFirstThreeDots() {\n  const isThreeDots = document.querySelector(\".page-buttons__first-points\");\n  if (isThreeDots === null) {\n    return false;\n  }\n  return true;\n}\n\n//проверка существования точек перед последней кнопкой\n//нужно для их рендера или удаления\nfunction isLastThreeDots() {\n  const isThreeDots = document.querySelector(\".page-buttons__last-points\");\n  if (isThreeDots === null) {\n    return false;\n  }\n  return true;\n}\n\nfunction renderFirstButtonAndDots() {\n  const firstButton = `<button id=\"paginationButton\" data-page=\"1\" class=\"button-page paginationButton\">1</button>`;\n  const threeDots = `<span class='page-buttons__first-points'>···</span>`;\n  refs.firstButton.insertAdjacentHTML(\"beforeend\", firstButton);\n  refs.firstButton.insertAdjacentHTML(\"beforeend\", threeDots);\n}\n\nfunction renderLastButtonAndDots(totalPages) {\n  const lastButton = `<button id=\"paginationButton\" data-page=\"${totalPages}\" class=\"button-page paginationButton\">${totalPages}</button>`;\n  const threeDots = `<span class='page-buttons__last-points'>···</span>`;\n  refs.lastButton.insertAdjacentHTML(\"beforeend\", threeDots);\n  refs.lastButton.insertAdjacentHTML(\"beforeend\", lastButton);\n}\n\n//Рендер кнопок и карточек по поиску.\nfunction renderPaginationOnSearch(query, queryPage) {\n  apiService.query = query;\n  apiService.page = queryPage;\n  apiService.fetchMoviesySearch().then(({ results, total_pages }) => {\n    if (results.length === 0) {\n      refs.inputError.textContent =\n        \"Search result not successful. Enter the correct movie name and smile : )\";\n      return;\n    }\n    clearFilmsContainer();\n    appendFilmsMarkup(results, refs.filmsContainerIndex);\n    resetButtons();\n    renderButtons(apiService.page, total_pages);\n  });\n}\n\n//Рендер кнопок и карточек популярных фильмов\nfunction renderPaginationPopular() {\n  apiService.page = page;\n  apiService.fetchPopular().then(({ results, total_pages }) => {\n    clearFilmsContainer();\n    appendFilmsMarkup(results, refs.filmsContainerIndex);\n    resetButtons();\n    renderButtons(apiService.page, total_pages);\n  });\n}\n\n//Чё рендерить-то - популярные или поиск? Вот функция и разбирается\n//Заодно после рендера поднимает вьюпорт в самый верх\nfunction isQueryOrPopular() {\n  if (apiService.query === \"\") {\n    renderPaginationPopular();\n    moveToTop();\n    return;\n  } else {\n    renderPaginationOnSearch(apiService.query, page);\n    moveToTop();\n  }\n}\n\n//функция для поднятия в небеса\nfunction moveToTop() {\n  window.scrollTo(pageXOffset, 0);\n}\n\nexport { renderButtons, renderPaginationOnSearch };\n","// import debounce from \"lodash.debounce\";\nimport ApiService from \"./API\";\nimport appendFilmsMarkup from \"./appendFilmsMarkup\";\nimport clearFilmsContainer from \"./clearFilmsContainer\";\nimport { renderPaginationOnSearch } from \"./pagination\";\n\nconst apiService = new ApiService();\n\nconst searchForm = document.querySelector(\".input__wraper\");\nconst inputError = document.querySelector(\".input__error\");\nconst filmsContainerIndex = document.querySelector(\".js-films-list-index\");\n\nsearchForm.addEventListener(\"submit\", onSearch);\n\nexport function onSearch(e) {\n  e.preventDefault();\n\n  apiService.query = e.currentTarget.searchQuery.value;\n  apiService.resetPage();\n\n  inputError.textContent = \" \";\n\n  renderPaginationOnSearch(apiService.query, apiService.page);\n\n  //Вибач, Наталю, але мені або зробити ось так, або переписувати половину свого коду :(\n\n  apiService\n    .fetchMoviesySearch()\n    .then(({ results, total_pages }) => {\n      if (results.length === 0) {\n        inputError.textContent =\n          \"Search result not successful. Enter the correct movie name and smile : )\";\n        return;\n      }\n      clearFilmsContainer();\n      appendFilmsMarkup(results, filmsContainerIndex);\n    })\n    .catch(error => console.log(error));\n}\n"],"names":["parcelRequire","$72Z32","$iZRpi","$6e1958cdf4558d68$var$apiService","default","$6e1958cdf4558d68$var$refs","arrowLeft","document","querySelector","arrowRight","pagination","firstButton","lastButton","filmsContainerIndex","inputError","$6e1958cdf4558d68$var$totalPages","$6e1958cdf4558d68$var$page","$6e1958cdf4558d68$export$8f52e704dc7391ad","currentPage","pages","beforeActivePage","afterActivePage","i","pageButton","insertAdjacentHTML","$6e1958cdf4558d68$var$isFirstThreeDots","threeDots","$6e1958cdf4558d68$var$renderFirstButtonAndDots","innerHTML","totalPages1","$6e1958cdf4558d68$var$renderLastButtonAndDots","onclick","$6e1958cdf4558d68$var$onClickArrowLeft","$6e1958cdf4558d68$var$onClickArrowRight","$6e1958cdf4558d68$var$onClickButton","$6e1958cdf4558d68$var$onClickFirstButton","$6e1958cdf4558d68$var$onClickLastButton","event","target","nodeName","$6e1958cdf4558d68$var$isQueryOrPopular","$6e1958cdf4558d68$var$resetButtons","preventDefault","currentTarget","Number","dataset","page","$6e1958cdf4558d68$export$64b427446bc657b7","query","queryPage","fetchMoviesySearch","then","results","total_pages","length","$fMtCK","textContent","fetchPopular","$6e1958cdf4558d68$var$moveToTop","window","scrollTo","pageXOffset","$1568500cd937aa28$var$apiService","$1568500cd937aa28$var$filmsContainerIndex","addEventListener","$533396e39deb84e7$var$apiService","$533396e39deb84e7$var$searchForm","$533396e39deb84e7$var$inputError","$533396e39deb84e7$var$filmsContainerIndex","e","searchQuery","value","resetPage","catch","error","console","log"],"version":3,"file":"index.be17366f.js.map"}